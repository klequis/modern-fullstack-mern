- [Database Commands](https://docs.mongodb.com/manual/reference/command/)
  - [Role Management Commands](https://docs.mongodb.com/manual/reference/command/nav-role-management/)
  - [createUser](https://docs.mongodb.com/manual/reference/command/#user-management-commands)



---
# Connect with authentication


https://mongodb.github.io/node-mongodb-native/2.0/tutorials/connecting/

var MongoClient = require('mongodb').MongoClient
  , assert = require('assert');

// Connection URL
var url = 'mongodb://dave:password@localhost:27017/myproject';
// Use connect method to connect to the Server
MongoClient.connect(url, function(err, db) {
  assert.equal(null, err);
  console.log("Connected correctly to server");

  db.close();
});


---
# Admin addUser()

https://mongodb.github.io/node-mongodb-native/2.0/api/Admin.html#addUser

> Don't use this one

---

# Db addUser()

https://mongodb.github.io/node-mongodb-native/2.0/api/Db.html#addUser


```js
import mongodb, { ObjectID } from 'mongodb'

const MongoClient = mongodb.MongoClient

let client

const connectDB = async () => {
  if (!client) {
    client = await MongoClient.connect(config.mongoUrl, {
      useNewUrlParser: true
    })
  }
  return { db: client.db(config.dbName) }
}


const close = async () => {
  if (client) {
    client.close()
  }
  client = undefined
}

const createUser = async () => {
  try {
    const { db } = await connectDB()
    const opts = {
      roles: [
        'find',
        'insert',
        'remove',
        'update',
      ]
    }
    const user = await db.addUser('testUser', 'password@1', opts)
    await db.close()
  }
  catch (e) {
    console.log('createUser:', e)
  }
}

```

var MongoClient = require('mongodb').MongoClient,
  test = require('assert');
MongoClient.connect('mongodb://localhost:27017/test', function(err, db) {
  // Add a user to the database
  db.addUser('user', 'name').then(function(result) {

    // Remove the user from the db
    db.removeUser('user').then(function(result) {
      db.close();
    });
  });
})
























