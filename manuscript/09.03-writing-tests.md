> TODO: I'm unable to find a reference for the return values of MongoDB methods.

In this section you'll get ready to write tests for the MongoDB wrapper functions in db/dbFunctions.js. I highly recommend reading through the [Mocha](https://mochajs.org/), [Chai](https://www.chaijs.com/) & [SuperTest](https://www.npmjs.com/package/supertest) documentation.

# Testing Libraries

We will be using [Mocha](https://mochajs.org/), [Chai](https://www.chaijs.com/) & [SuperTest](https://www.npmjs.com/package/supertest)

## Mocha
Mocha is a feature-rich JavaScript test framework running on Node.js and in the browser, making asynchronous testing simple and fun. Mocha tests run serially, allowing for flexible and accurate reporting, while mapping uncaught exceptions to the correct test cases.

## Chai
Chai is a BDD / TDD assertion library for node and the browser that can be delightfully paired with any javascript testing framework.

## SuperTest
Supertest is a library made specifically for testing nodejs http servers. It has a very simple syntax that makes the task of testing HTTP calls fairly simple.

# Mocha's Hooks
Mocha implements four [hooks](https://mochajs.org/#hooks): `before`, `after` `beforeEach` and `afterEach`, which are used to setup preconditions and clean-up after tests.

## Hook Scope
The scope of the hook depends upon where it is placed.

### Hooks outside of all `describe`  blocks
Hooks outside of all `describe` block  are called 'root-level hooks'.
- `before`: will run once before all tests
- `after`: will run once after all tests have completed
- `beforeEach`: will run once before each test
- `afterEach`: will run once after each test

### Hooks inside a `describe` block
- `before`: will run once before the tests in the `describe` block
- `after`: will run once after the tests in the `describe` block
- `beforeEach`: will run once before each test in the `describe` block
- `afterEach`: will run once after each test in the `describe` block

Let's look at an example of using `before` and `after`
```js
before('root before', function rootBefore() {
  console.log('root before')
})

after( async () => {
  console.log('root after')
})

describe('wrapper', () => {
  describe('nested.1', function() {
    before('before nested.1', function() {
      console.log('      before inside nested.1')
    })
    it('test1.1', function() {
    })
    it('test1.2', function() {
    })
    after('after nested.1', function() {
      console.log('      after inside nested.1')
    })
  })
  describe('nested.2', function() {
    before('before nested.2', function() {
      console.log('      before inside nested.2')
    })
    it('test2.1', function() {
    })
    it('test2.2', function() {
    })
    after('after nested.2', function() {
      console.log('      after inside nested.2')
    })
  })
})
```
Running these test produces the output:
```console
root before
  wrapper
    nested.1
      before inside nested.1
      ✓ test1.1
      ✓ test1.2
      after inside nested.1
    nested.2
      before inside nested.2
      ✓ test2.1
      ✓ test2.2
      after inside nested.2

root after
```

Note:
- The root `before` runs once before any test test run
- The root `after` run once after all tests have completed
- For nested.1 and nested.2 describe blocks, `before` runs before the tests in the block start and `after` runs following the completion of all tests in the block

Now let's look at the behavior of `beforeEach` and `afterEach`.
```js
beforeEach(function rootbeforeEach() {
  console.log('root beforeEach')
})

afterEach( async function() {
  console.log('root afterEach')
})

describe('wrapper', function() {
  describe('nested.1', function() {
    beforeEach(function() {
      console.log('      beforeEach inside nested.1')
    })
    it('test1.1', function() {
    })
    it('test1.2', function() {
    })
    afterEach('after nested.1', function() {
      console.log('      afterEach inside nested.1')
    })
  })
  describe('nested.2', function() {
    beforeEach(function() {
      console.log('      beforeEach inside nested.2')
    })
    it('test2.1', function() {
    })
    it('test2.2', function() {
    })
    after(function() {
      console.log('      afterEach inside nested.2')
    })
  })
})

```
Note
- Every `beforeEach`, at the root level and those inside a describe block, runs before each test
- Every `afterEach`, at the root and those inside a describe block, runs after the completion of each test

# Chai
Chai has three [assertion styles](https://www.chaijs.com/guide/styles/), Should, Expect and Assert. The choice of interface affects the syntax of the tests. We will be using the [Expect style](https://www.chaijs.com/guide/styles/#expect). Both Expect and Should styles are BDD style tests. A reference for the syntax and usage can be found [here](https://www.chaijs.com/api/bdd/).



