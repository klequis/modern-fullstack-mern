# Installing Nginx

## Ref
- https://www.digitalocean.com/community/tutorials/how-to-install-nginx-on-ubuntu-18-04

```js
sudo apt update
sudo apt install nginx
sudo ufw status
```
## Adjust the Firewall

```js
sudo ufw app list
sudo ufw allow 'Nginx HTTP'
sudo ufw status
```
## Check Web server

```js
systemctl status nginx
```

View default page in browser

You should now be able to use the servers ip address to see the default nginx page

```js
http://your_server_ip
```

## Set-up Server Block

Create directory for new site

```js
sudo mkdir -p /var/www/api.klequis-todo.tk/html
```
Assign ownership to 'doadmin'.

```js
sudo chown -R $USER:$USER /var/www/api.klequis-todo.tk/html
```

The sites folder should have 755 permission. If not ...

```js
sudo chmod -R 755 /var/www/api.klequis-todo.tk
```

Create a web page to display

```
nano /var/www/api.klequis-todo.tk/html/index.html
```

Make the contents of the page as follows:

```html
<html>
    <head>
        <title>Welcome to api.klequis-todo.tk!</title>
    </head>
    <body>
        <h1>Success!  The api.klequis-todo.tk server block is working!</h1>
    </body>
</html>
```

Create the server block

```js
sudo nano /etc/nginx/sites-available/api.klequis-todo.tk
```

With the contents as

```js
server {
        listen 80;
        listen [::]:80;

        root /var/www/api.klequis-todo.tk/html;
        index index.html index.htm;

        server_name api.klequis-todo.tk www.api.klequis-todo.tk;

        location / {
                try_files $uri $uri/ =404;
        }
}
```

Enable the server block.

```js
sudo ln -s /etc/nginx/sites-available/api.klequis-todo.tk /etc/nginx/sites-enabled/
```

Change the hash bucket size.

```js
sudo nano /etc/nginx/nginx.conf
```

Uncomment the line

```js
server_names_hash_bucket_size 64;
```

Check the configuration.

```js
sudo nginx -t
```

Restart Nginx

```js
sudo systemctl restart nginx
```

Now visit the site again in the browser. You should see the new page.

> TIP: If visiting the site from the browser doesn't work at all, try restarting the server.

> TIP: It is possible that when visiting your site via ipaddress you will continue to get directed to the default page even though you did everything correctly. Try clearing your browsers cache. If that doesn't work then delete the default site:
