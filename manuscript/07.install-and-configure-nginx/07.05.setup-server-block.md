## 07.05 Set-up Server Block

Create directory for new site

```
sudo mkdir -p /var/www/api.klequis-todo.tk/html
```
Assign ownership to 'doadmin'.

```
sudo chown -R $USER:$USER /var/www/api.klequis-todo.tk/html
```

The sites folder should have 755 permission. If not ...


> This is rare but it did happen to me once so do check it.
> Ut-oh. I checked the file and not the directory :( Do check both and see what needs to be done.
> Actually, I seem to have the whole thing wrong :(. I checked the html directory but it should be the api.klequis-todo.tk directory.

check it: stat --format '%a' index.html

```
sudo chmod -R 755 /var/www/api.klequis-todo.tk
```

Create a web page to display

```
nano /var/www/api.klequis-todo.tk/html/index.html
```

Make the contents of the page as follows:

```html
<html>
    <head>
        <title>Welcome to api.klequis-todo.tk!</title>
    </head>
    <body>
        <h1>Success!  The api.klequis-todo.tk server block is working!</h1>
    </body>
</html>
```

> Use ctrl-o, enter, ctrl-x to save and exit.

Create the server block

```
sudo nano /etc/nginx/sites-available/api.klequis-todo.tk
```

With the contents as

```
server {
        listen 80;
        listen [::]:80;

        root /var/www/api.klequis-todo.tk/html;
        index index.html index.htm;

        server_name api.klequis-todo.tk www.api.klequis-todo.tk;

        location / {
                try_files $uri $uri/ =404;
        }
}
```

Enable the server block.

```
sudo ln -s /etc/nginx/sites-available/api.klequis-todo.tk /etc/nginx/sites-enabled/
```

Change the hash bucket size.

```
sudo nano /etc/nginx/nginx.conf
```

Uncomment the line

```
server_names_hash_bucket_size 64;
```

Check the configuration.

```
sudo nginx -t
```

Restart Nginx

```
sudo systemctl restart nginx
```

Now visit the site again in the browser, this time using your domain which for me would be `api.klequis-todo.tk`. You should see the new page.

> TODO: If you delete the default site the ip address will go to the new page. However, this is not desired. Perhaps a 'not found' pages should be in default. If you use Microsoft's ip address you get not found.

> TODO: Here is Microsoft's not found page:

```html
<html><head><style>@media print {#ghostery-purple-box {display:none !important}}</style></head><body style="
    font-size: 55px;
    font-family: monospace;
    color: rgb(48,125,255);
">
    <div style="margin: auto; width: 50%; text-align: center; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%)">
        <img src="data:image/png;base64,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" style="margin-bottom: -5px;">ot found</div>
</body></html>
```
